<h1 id="votefactory-sol">VoteFactory.sol</h1>
<p>We will be calling acaemic institutes and/or enterprises wishing to emit certificates entities. When one of such postulates as one, it interacts with the VoteFactory contract, which uses an upgradeable EIP1167 implementation, creating a clone of the Vote contract.</p>
<ul>
<li>Implements EIP1167 standard to clone instances of the Vote.sol contract.  </li>
<li>Stores all deployed clones at clones mapping.  </li>
<li>Stores all validated entities at entities mapping.  </li>
<li>Entities interact wit this contract when postulating/repostulating.</li>
<li>Badge contracts interact with IVF to check if an address is an entity.</li>
<li>Devs can interact with the View Methods to retrieve information about the current state of the contract.</li>
<li>Admin should interact with VoteFactory to change contract state. </li>
</ul>
<p><img src="https://user-images.githubusercontent.com/66641667/175523951-94a143a4-f573-4abb-a994-4a047ba0dc5d.png" alt="ProxyPattern"></p>
<h1 id="events">Events</h1>
<ul>
<li><h3 id="ethreceived">EthReceived</h3>
<ul>
<li><h3 id="params-">Params:</h3>
<ul>
<li><strong>address indexed _sender</strong></li>
<li><strong>uint256 _amount</strong></li>
</ul>
<p>Emited at fallback function.</p>
</li>
</ul>
</li>
<li><h3 id="entityadded">EntityAdded</h3>
<ul>
<li><h3 id="params-">Params:</h3>
<ul>
<li><strong>address indexed _newEntity</strong> -&gt; New validated entity</li>
<li><strong>address _caledBy</strong> -&gt; Contract(VoteProxy) that called the function.</li>
</ul>
<p>Emited at Vote finish, from a Vote clone, if result if 1.</p>
</li>
</ul>
</li>
<li><h3 id="proxycreated">ProxyCreated</h3>
<ul>
<li><h3 id="params-">Params:</h3>
<ul>
<li><strong>address indexed proxy</strong> -&gt; Address of the newly created vote clone/instance.</li>
</ul>
<p>Emited at Vote cloning.</p>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="methods-">Methods:</h1>
<h2 id="_entity-related-methods_"><em>Entity-related methods</em></h2>
<h3 id="__createvote-uint256-votingcost-uint256-minvotes-uint256-timetovote-__"><strong>createVote(uint256 votingCost, uint256 minVotes, uint256 timeToVote)</strong></h3>
<h3 id="params-">Params:</h3>
<ul>
<li><strong>votingCost:</strong> should be N usd, info gathered in the front-end</li>
<li><strong>minVotes:</strong> minimal votes to win votation</li>
<li><strong>timeToVote:</strong> days to vote, should be at least N days.</li>
</ul>
<h3 id="returns-">Returns:</h3>
<ul>
<li>A boolean value indicating whether the operation succeeded.</li>
</ul>
<p>Can be called by everyone.
Creates an instance of the vote proxy contract and emits a {ProxyCreated} event, then initializes the Clone/Proxy.
Entities call this function at postulation.</p>
<h3 id="reverts-on-">Reverts on:</h3>
<ul>
<li>Invalid input(_votingCost == 0 || _minVotes &lt; 2 || _timeToVote &lt; 2)</li>
<li>msg.sender already postulated</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createVote</span><span class="hljs-params">(
    uint256 _votingCost,
    uint256 _minVotes,
    uint256 _timeToVote
)</span> <span class="hljs-title">public</span> <span class="hljs-title">payable</span> </span>{
    address _voteProxy = <span class="hljs-keyword">this</span>.deployMinimal(voteImpl);

    Vote(_voteProxy).initialize(
        _votingCost,
        _minVotes,
        _timeToVote,
        msg.sender
    );

    postulations[msg.sender] = <span class="hljs-literal">true</span>;
    clones[_voteProxy] = <span class="hljs-literal">true</span>;
}
</code></pre>
<hr>
<h3 id="__repostulationallowance-__"><strong>rePostulationAllowance()</strong></h3>
<p>Allows entity to repostulate. If entity sends especified amount of ethers to the function, it is allowed to iniciate a new vote.
Entity should not be validated(lost at previous votation).</p>
<h3 id="reverts-on-">Reverts on:</h3>
<ul>
<li>Call by an already validated entity.</li>
<li>msg.value != reAlowanceValue</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function">function <span class="hljs-title">rePostulationAllowance</span>(<span class="hljs-params"></span>) <span class="hljs-keyword">public</span> payable </span>{
    <span class="hljs-keyword">if</span>(postulations[msg.sender] &amp;&amp; entities[msg.sender])
        <span class="hljs-function">revert <span class="hljs-title">AlreadySelectedAsEntity</span>(<span class="hljs-params">msg.sender</span>)</span>;
    <span class="hljs-keyword">if</span>(msg.<span class="hljs-keyword">value</span> != reAlowanceValue)
        <span class="hljs-function">revert <span class="hljs-title">InvalidInput</span>(<span class="hljs-params">msg.<span class="hljs-keyword">value</span></span>)</span>;

    postulations[msg.sender] = <span class="hljs-literal">false</span>;
}
</code></pre>
<hr>
<h2 id="_view-and-info-retrieving-methods_"><em>View and info-retrieving methods</em></h2>
<h3 id="__getimpladdr-__"><strong>getImplAddr()</strong></h3>
<p>Get the current implementation Address</p>
<h3 id="returns-">Returns:</h3>
<ul>
<li>address of the Vote contract from which clones are created.</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getImplAddr</span><span class="hljs-params">()</span> <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> <span class="hljs-params">(address)</span> </span>{
    <span class="hljs-keyword">return</span> voteImpl;
}
</code></pre>
<hr>
<h3 id="__getadmin-__"><strong>getAdmin()</strong></h3>
<p>Get the current administrator Address</p>
<h3 id="returns-">Returns:</h3>
<ul>
<li>address of contract admin.</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAdmin</span><span class="hljs-params">()</span> <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> <span class="hljs-params">(address)</span> </span>{
    <span class="hljs-keyword">return</span> admin;
}
</code></pre>
<hr>
<h3 id="__isentity-_addr-__"><strong>isEntity(_addr)</strong></h3>
<p>Check if a given address is a validated entity.</p>
<h3 id="params-">Params:</h3>
<ul>
<li><strong>_addr</strong> address of the entity to be queried.<h3 id="returns-">Returns:</h3>
</li>
<li>Boolean value stating if address is a validated entity.  </li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEntity</span><span class="hljs-params">(address _addr)</span> <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> <span class="hljs-params">(bool)</span> </span>{
    <span class="hljs-keyword">return</span> entities[_addr];
}
</code></pre>
<hr>
<h3 id="__getpostulated-address-_addr-__"><strong>getPostulated(address _addr)</strong></h3>
<p>Check if a given address has postulated.</p>
<h3 id="params-">Params:</h3>
<ul>
<li><strong>_addr</strong> address of the entity to be queried.<h3 id="returns-">Returns:</h3>
</li>
<li>Boolean value stating if address has postulated.  </li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasPostulated</span><span class="hljs-params">(address _addr)</span> <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> <span class="hljs-params">(bool)</span> </span>{
    <span class="hljs-keyword">return</span> postulations[_addr];
}
</code></pre>
<hr>
<h2 id="_admin-methods_"><em>Admin methods</em></h2>
<h3 id="__changeimpl-address-_newvoteimpl-__"><strong>changeImpl(address _newVoteImpl)</strong></h3>
<h3 id="params-">Params:</h3>
<ul>
<li><strong>_newVoteImpl</strong> address of the new Vote implementation</li>
</ul>
<p>Only callable by Admin.<br>Changes the address from which vote contracts are cloned.</p>
<h3 id="reverts-on-">Reverts on:</h3>
<ul>
<li>Call by everyone if not Admin.</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeImpl</span></span>(address _new<span class="hljs-type">VoteImpl</span>) <span class="hljs-keyword">public</span> onlyAdmin {
    voteImpl = _new<span class="hljs-type">VoteImpl</span>;
}
</code></pre>
<hr>
<h3 id="__changealowancevalue-uint256-_newvalue-__"><strong>changeAlowanceValue(uint256 _newValue)</strong></h3>
<h3 id="params-">Params:</h3>
<ul>
<li><strong>_newValue</strong> new amount to pay when repostulating.</li>
</ul>
<p>Only callable by Admin.<br>_newValue should be parsed as GWEI.<br>Changes the value of reAlowanceValue.</p>
<h3 id="reverts-on-">Reverts on:</h3>
<ul>
<li>call by everyone if not Admin.</li>
<li>&#39;_newValue&#39; equal to cero or equal to previous value.</li>
</ul>
<pre><code class="lang-solidity"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeAlowanceValue</span></span>(uint256 _new<span class="hljs-type">Value</span>) external payable onlyAdmin {
    <span class="hljs-keyword">if</span>(_new<span class="hljs-type">Value</span> == reAlowanceValue || _new<span class="hljs-type">Value</span> == <span class="hljs-number">0</span>)
        revert InvalidInput(_new<span class="hljs-type">Value</span>);
    reAlowanceValue = _new<span class="hljs-type">Value</span>;
}
</code></pre>
<hr>
<ul>
<li><h3 id="-matias-arazi-https-github-com-matiarazi-"><a href="https://github.com/MatiArazi">Matias Arazi</a></h3>
</li>
<li><h3 id="-lucas-grasso-https-github-com-lucasgrasso-"><a href="https://github.com/LucasGrasso">Lucas Grasso</a></h3>
</li>
</ul>
<hr>